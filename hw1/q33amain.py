import numpy as np
import pandas as pd
import os
import math
import time

## Change root to where the CSV files are located.
root = r'C:\Users\User\Desktop\hw3'
os.chdir(root)

# If CSV's are named differently, change them here.
train_x_csv = root + '\sms_train_features.csv'
train_y_csv = root + '\sms_train_labels.csv'
test_x_csv = root + '\sms_test_features.csv'
test_y_csv = root + '\sms_test_labels.csv'

############BEGINNING OF BERNOULLI############
def Bernoulli():
    train_x = pd.read_csv(train_x_csv)
    train_y = pd.read_csv(train_y_csv)
    test_x = pd.read_csv(test_x_csv)
    test_y = pd.read_csv(test_y_csv)

    train_x.drop('Unnamed: 0', inplace=True, axis=1)
    train_y.drop('Unnamed: 0', inplace=True, axis=1)
    test_x.drop('Unnamed: 0', inplace=True, axis=1)
    test_y.drop('Unnamed: 0', inplace=True, axis=1)
    test_y = test_y.values.tolist()

    #merge labels to features
    train_x['class'] = train_y


    start = 0
    end = len(train_x.columns) - 1
    mi_scores = dict()

    for i in range(start, end):
        N11 = 0
        N10 = 0
        N00 = 0
        N01 = 0
        N0_ = 0
        N1_ = 0
        N_0 = 0
        N_1 = 0
        N = 0
        for index, row in train_x.iterrows():
            if row[str(i)] == 0 and row['class'] == 0:
                N00 += 1
            elif row[str(i)] == 0 and row['class'] == 1:
                N01 += 1
            elif row[str(i)] == 1 and row['class'] == 0:
                N10 += 1
            elif row[str(i)] == 1 and row['class'] == 1:
                N11 += 1
        N0_ = N01 + N00
        N_0 = N00 + N10
        N_1 = N11 + N01
        N1_ = N11 + N10
        N = N11 + N01 + N10 + N00

        a = math.log2(N*N11/(N1_*N_1)) if N*N11 > 0 else -math.inf
        b = math.log2(N*N01/(N0_*N_1)) if N*N01 > 0 else -math.inf
        c = math.log2(N * N10/(N1_*N_0)) if N * N10 > 0 else -math.inf
        d = math.log2(N * N00/(N0_*N_0)) if N * N00 > 0 else -math.inf

        mi_score = (N11/N)*a + \
                   (N01/N)*b + \
                   (N10/N)*c + \
                   (N00/N)*d
        if math.isnan(mi_score):
            mi_scores[str(i)] = 0
        else:
            mi_scores[str(i)] = mi_score



    #mi_scores = {'0': 1.2718482477513165e-05, '1': 0.00024325936987509034, '2': 0, '3': 0, '4': 0.00011127447664787847, '5': 0, '6': 0, '7': 0, '8': 0, '9': 0, '10': 0, '11': 0, '12': 0, '13': 0, '14': 0.0013171709288980302, '15': 0, '16': 0.0007442960070478078, '17': 0, '18': 0, '19': 0.00024325936987509034, '20': 0.0033670389442333097, '21': 0, '22': 0, '23': 0, '24': 0, '25': 0, '26': 0, '27': 0, '28': 0, '29': 0, '30': 0.0013135295352026898, '31': 0, '32': 0, '33': 0, '34': 0, '35': 0, '36': 0, '37': 0.0003292747100892738, '38': 0, '39': 4.94777762348758e-06, '40': 0, '41': 0, '42': 0, '43': 0, '44': 0, '45': 0, '46': 0.001915429015981867, '47': 0, '48': 0, '49': 0, '50': 0, '51': 0, '52': 0, '53': 0, '54': 0, '55': 0, '56': 0, '57': 0.00011127447664787847, '58': 0, '59': 0, '60': 0, '61': 0.0012223068012562543, '62': 0, '63': 0, '64': 0, '65': 0, '66': 0, '67': 0, '68': 0, '69': 0, '70': 0, '71': 0, '72': 0, '73': 0, '74': 0, '75': 0, '76': 0, '77': 0, '78': 0, '79': 0, '80': 0, '81': 0, '82': 0, '83': 0, '84': 0, '85': 0, '86': 0.0013135992346853457, '87': 0, '88': 0, '89': 0, '90': 0, '91': 0, '92': 0, '93': 0, '94': 0, '95': 0.00024325936987509034, '96': 0, '97': 0, '98': 0, '99': 0, '100': 0, '101': 0.00024325936987509034, '102': 0, '103': 0, '104': 0, '105': 0, '106': 0, '107': 0.0007659022268976623, '108': 0, '109': 0, '110': 0, '111': 0, '112': 0, '113': 0, '114': 0, '115': 0, '116': 0, '117': 0, '118': 0, '119': 0, '120': 0, '121': 0, '122': 0, '123': 0.01566693245792742, '124': 0, '125': 0, '126': 0, '127': 0, '128': 0, '129': 0, '130': 0, '131': 0, '132': 0, '133': 0, '134': 0.0004356512516995243, '135': 0, '136': 0, '137': 0, '138': 0, '139': 0, '140': 0, '141': 0, '142': 4.697788264751559e-05, '143': 0, '144': 0.0025367857823673694, '145': 0, '146': 0, '147': 0, '148': 0, '149': 0, '150': 0, '151': 0, '152': 0, '153': 0, '154': 0, '155': 0, '156': 0, '157': 0, '158': 0, '159': 0, '160': 0, '161': 0, '162': 0, '163': 0, '164': 0, '165': 0, '166': 0, '167': 0.009818156553801544, '168': 0, '169': 0, '170': 0, '171': 0, '172': 0, '173': 0.002058754887417318, '174': 0, '175': 0.0007442960070478078, '176': 0, '177': 0, '178': 0, '179': 0, '180': 6.917409561299579e-05, '181': 0.0007308374009483905, '182': 0, '183': 0, '184': 0, '185': 0, '186': 0.011864278595157745, '187': 0, '188': 0.005837813151458361, '189': 4.94777762348758e-06, '190': 0, '191': 0, '192': 0, '193': 0, '194': 0, '195': 0.00016344540915494042, '196': 0.00013735374858857784, '197': 0, '198': 0, '199': 0, '200': 0, '201': 0, '202': 0, '203': 0, '204': 0.0024485604502319383, '205': 0, '206': 0, '207': 0, '208': 0, '209': 0, '210': 0, '211': 1.4815046922534502e-05, '212': 0, '213': 0, '214': 0, '215': 0, '216': 0, '217': 0, '218': 0, '219': 0, '220': 0, '221': 0, '222': 0, '223': 0, '224': 0, '225': 0, '226': 0, '227': 0, '228': 0, '229': 0, '230': 0, '231': 0, '232': 0, '233': 0, '234': 0, '235': 0, '236': 0, '237': 0, '238': 0, '239': 0, '240': 0, '241': 0, '242': 0, '243': 0, '244': 0, '245': 0, '246': 0.00024325936987509034, '247': 0, '248': 0, '249': 1.4837639435532309e-05, '250': 0, '251': 0, '252': 0, '253': 3.2016946474618135e-05, '254': 0, '255': 0, '256': 0, '257': 0, '258': 0, '259': 0, '260': 0, '261': 0.00011127447664787847, '262': 0, '263': 0, '264': 0, '265': 5.0088237113175935e-05, '266': 0, '267': 0, '268': 0, '269': 0.0009521908913427723, '270': 0, '271': 0.00024325936987509034, '272': 0, '273': 0.0003539913479996647, '274': 0, '275': 0.0007442960070478078, '276': 0, '277': 0, '278': 0, '279': 0, '280': 0, '281': 0, '282': 4.697788264751559e-05, '283': 0, '284': 0, '285': 0.00026995759870524513, '286': 0, '287': 4.697788264751559e-05, '288': 0, '289': 0, '290': 1.6440664123143278e-06, '291': 0, '292': 0, '293': 0, '294': 0, '295': 0, '296': 0, '297': 0, '298': 0, '299': 0, '300': 0, '301': 0, '302': 0, '303': 0, '304': 0, '305': 0.00011127447664787847, '306': 0, '307': 0, '308': 0, '309': 0.0007442960070478078, '310': 0, '311': 0, '312': 1.476986865320539e-05, '313': 0, '314': 0, '315': 0, '316': 0, '317': 0, '318': 0, '319': 0, '320': 0, '321': 0, '322': 0, '323': 0, '324': 0, '325': 0, '326': 0.0006536676219530309, '327': 0, '328': 0, '329': 0, '330': 0, '331': 0, '332': 0, '333': 0, '334': 0, '335': 0, '336': 0, '337': 0, '338': 0, '339': 0, '340': 0, '341': 0, '342': 1.4837639435532309e-05, '343': 0.00023076689705280094, '344': 0, '345': 0, '346': 0.014738033547758728, '347': 0, '348': 0, '349': 0, '350': 0, '351': 0.0013135295352026898, '352': 0, '353': 0, '354': 0, '355': 0.00010085126318516485, '356': 0, '357': 0, '358': 0, '359': 0, '360': 0, '361': 0, '362': 0, '363': 0, '364': 0, '365': 0, '366': 0, '367': 0, '368': 0, '369': 0, '370': 0, '371': 0, '372': 0, '373': 0, '374': 0, '375': 0, '376': 0, '377': 0, '378': 0, '379': 0, '380': 0, '381': 0.0002689670451802808, '382': 0.00011127447664787847, '383': 0, '384': 0, '385': 0, '386': 0, '387': 0, '388': 0, '389': 0, '390': 0, '391': 0, '392': 0, '393': 0, '394': 0, '395': 0, '396': 0, '397': 0, '398': 0, '399': 0, '400': 0, '401': 0, '402': 0, '403': 0, '404': 0, '405': 0, '406': 1.846419779912405e-05, '407': 0, '408': 0, '409': 0, '410': 0.0005525205876178347, '411': 0, '412': 0, '413': 0, '414': 0, '415': 0, '416': 0, '417': 0, '418': 0, '419': 0, '420': 0, '421': 0, '422': 0.005122665558947172, '423': 0.00040318483776343264, '424': 0, '425': 0.00048687154332162857, '426': 0.00047791199493576683, '427': 0.012331952044027992, '428': 0, '429': 0, '430': 0, '431': 0, '432': 0, '433': 0.0011965037502085492, '434': 0, '435': 0, '436': 0, '437': 0.00024325936987509034, '438': 0, '439': 0, '440': 0.00010093887113761193, '441': 0, '442': 0.0007478903592002839, '443': 4.697788264751559e-05, '444': 0.0007442960070478078, '445': 0, '446': 0, '447': 0, '448': 0, '449': 0, '450': 0, '451': 0, '452': 0, '453': 0.027423402037836886, '454': 0, '455': 0, '456': 0, '457': 0, '458': 0, '459': 0, '460': 0, '461': 0, '462': 0, '463': 0, '464': 0, '465': 0, '466': 0, '467': 0, '468': 0, '469': 0, '470': 0, '471': 0, '472': 0, '473': 0.0007442960070478078, '474': 0, '475': 0, '476': 0, '477': 0, '478': 0, '479': 0, '480': 0, '481': 0.009025219414589284, '482': 0, '483': 0, '484': 0, '485': 0, '486': 0, '487': 0, '488': 0.002448625438405655, '489': 0, '490': 0, '491': 0, '492': 0, '493': 0.00011127447664787847, '494': 0, '495': 0.006921180208061463, '496': 0, '497': 0, '498': 0.00043443537095040467, '499': 0, '500': 0, '501': 0.00015628802606244125, '502': 0, '503': 0, '504': 0, '505': 0, '506': 0, '507': 0, '508': 0, '509': 0, '510': 0, '511': 0, '512': 0, '513': 0, '514': 0, '515': 0, '516': 0, '517': 0, '518': 0, '519': 0, '520': 0.00011127447664787847, '521': 0, '522': 0, '523': 0, '524': 0, '525': 0, '526': 0, '527': 0, '528': 0, '529': 0.0013135295352026898, '530': 0.002163525866836418, '531': 0, '532': 0, '533': 0, '534': 0, '535': 0, '536': 0, '537': 0.0003292747100892738, '538': 0, '539': 0.00048687154332162857, '540': 0, '541': 0, '542': 0, '543': 0, '544': 0, '545': 0, '546': 0, '547': 0, '548': 0, '549': 0, '550': 0, '551': 0, '552': 0, '553': 0, '554': 0, '555': 0.0007454424046742624, '556': 0, '557': 0, '558': 0, '559': 0.00023782188916300455, '560': 0, '561': 0, '562': 0, '563': 0, '564': 0, '565': 0, '566': 0.005804077486274229, '567': 0, '568': 0, '569': 0, '570': 0, '571': 0, '572': 0, '573': 0.00011127447664787847, '574': 0, '575': 0.013236143766668243, '576': 0, '577': 0, '578': 0, '579': 0, '580': 0, '581': 0, '582': 0, '583': 0.00892359764867975, '584': 0.00024325936987509034, '585': 0, '586': 0, '587': 0, '588': 0.004697103719400971, '589': 0, '590': 0, '591': 0, '592': 0.006712782567911181, '593': 0, '594': 0.00019412407987187035, '595': 0, '596': 0, '597': 0, '598': 0, '599': 0, '600': 0, '601': 0, '602': 0.0007442960070478078, '603': 0, '604': 2.6715619077119074e-08, '605': 0, '606': 0, '607': 0, '608': 0.0009628048322442895, '609': 0, '610': 0, '611': 0, '612': 0, '613': 1.6440664123143278e-06, '614': 1.6440664123143278e-06, '615': 0, '616': 0, '617': 0, '618': 0, '619': 0.0003344688332624547, '620': 0, '621': 0, '622': 0, '623': 0, '624': 0.00011127447664787847, '625': 0, '626': 0, '627': 0, '628': 0, '629': 6.841382371081405e-05, '630': 0, '631': 0, '632': 0, '633': 0.00024325936987509034, '634': 0, '635': 4.697788264751559e-05, '636': 0, '637': 0, '638': 0, '639': 0, '640': 0, '641': 0, '642': 0, '643': 0, '644': 0, '645': 0.02205489889188504, '646': 0.005790680222586818, '647': 0, '648': 0, '649': 0, '650': 0, '651': 0, '652': 0, '653': 0.0014903337149599887, '654': 0, '655': 0, '656': 0, '657': 0, '658': 0, '659': 0, '660': 0, '661': 0, '662': 0, '663': 0, '664': 0, '665': 0.0005010686202746957, '666': 0, '667': 0, '668': 0, '669': 0, '670': 0.0003344688332624547, '671': 0, '672': 0, '673': 0, '674': 0, '675': 0.01294823911436039, '676': 0, '677': 0, '678': 0, '679': 0, '680': 0, '681': 0, '682': 0, '683': 0.0007308374009483905, '684': 6.841382371081405e-05, '685': 0, '686': 0, '687': 0, '688': 0, '689': 0, '690': 0, '691': 0, '692': 0, '693': 0, '694': 0, '695': 0, '696': 0, '697': 0, '698': 0, '699': 0, '700': 0.00019277798105768175, '701': 0, '702': 0, '703': 0, '704': 0.0022381208685870726, '705': 0, '706': 0, '707': 0, '708': 0, '709': 0, '710': 0, '711': 0, '712': 0.0007442960070478078, '713': 0, '714': 0, '715': 0, '716': 0, '717': 0, '718': 0, '719': 0.0007442960070478078, '720': 0, '721': 0, '722': 0, '723': 0, '724': 0.0007638296588196539, '725': 0, '726': 0.0009751578266891523, '727': 0, '728': 0, '729': 0, '730': 0.0003292747100892738, '731': 0.003367222845342319, '732': 0, '733': 0, '734': 0.021938171753656754, '735': 0, '736': 1.4837639435532309e-05, '737': 0, '738': 0, '739': 0, '740': 0, '741': 0, '742': 0.0013135295352026898, '743': 0, '744': 0, '745': 0, '746': 0, '747': 0, '748': 0, '749': 0, '750': 0, '751': 0, '752': 0.00011127447664787847, '753': 0, '754': 0.0003292747100892738, '755': 0, '756': 0, '757': 0, '758': 0.0016103804609845823, '759': 0, '760': 0.0007365263888044291, '761': 0.0002484807970757339, '762': 0, '763': 0, '764': 0, '765': 0, '766': 0, '767': 6.403608965041877e-05, '768': 0, '769': 0, '770': 0, '771': 0, '772': 0, '773': 0, '774': 0, '775': 0, '776': 0, '777': 0, '778': 0, '779': 0, '780': 0, '781': 0, '782': 0, '783': 0, '784': 0, '785': 0, '786': 0, '787': 1.4837639435532309e-05, '788': 0, '789': 0, '790': 0, '791': 0, '792': 0, '793': 0, '794': 0.011180573339346696, '795': 0, '796': 0, '797': 0, '798': 0, '799': 0, '800': 0, '801': 0, '802': 0, '803': 0, '804': 0, '805': 0, '806': 0, '807': 0, '808': 0, '809': 0, '810': 0, '811': 0, '812': 0, '813': 0, '814': 0, '815': 0, '816': 0, '817': 0, '818': 0, '819': 0, '820': 0, '821': 0, '822': 0, '823': 0, '824': 0, '825': 0, '826': 0, '827': 0, '828': 0.00024325936987509034, '829': 0, '830': 0, '831': 0, '832': 0, '833': 0, '834': 0.0035412970002419546, '835': 0, '836': 0, '837': 0, '838': 0, '839': 0, '840': 0, '841': 0, '842': 0, '843': 0, '844': 0, '845': 0, '846': 0, '847': 0, '848': 0, '849': 0, '850': 0, '851': 0, '852': 0, '853': 0, '854': 0, '855': 0, '856': 0.0044581991216803615, '857': 0, '858': 0, '859': 0, '860': 0, '861': 8.408186694499342e-06, '862': 0, '863': 0, '864': 0, '865': 0, '866': 0, '867': 0, '868': 0, '869': 0, '870': 0.0038385614128827765, '871': 0, '872': 0, '873': 0, '874': 0, '875': 0, '876': 0, '877': 0, '878': 0, '879': 0, '880': 0, '881': 0, '882': 0, '883': 0, '884': 0, '885': 0, '886': 0, '887': 0, '888': 0, '889': 0, '890': 0.00022268187007793133, '891': 0, '892': 0, '893': 0, '894': 0, '895': 0, '896': 0, '897': 0, '898': 0, '899': 0, '900': 0, '901': 0, '902': 0, '903': 0.002260935859929659, '904': 0, '905': 0.0006067253145992106, '906': 0, '907': 1.6440664123143278e-06, '908': 0, '909': 0, '910': 0, '911': 0.00024325936987509034, '912': 0.0029043941061059537, '913': 0, '914': 0, '915': 0, '916': 0, '917': 0, '918': 0.0208976912707206, '919': 0.0004343480624694106, '920': 0, '921': 0, '922': 0, '923': 0, '924': 0, '925': 0, '926': 0, '927': 0, '928': 8.304283372221772e-06, '929': 0, '930': 0, '931': 0, '932': 0, '933': 0, '934': 0, '935': 0, '936': 0, '937': 0, '938': 0, '939': 0, '940': 0, '941': 0, '942': 0, '943': 0, '944': 0, '945': 0, '946': 0, '947': 0, '948': 0, '949': 0, '950': 0, '951': 0, '952': 0, '953': 0, '954': 0, '955': 0, '956': 0, '957': 0.00024325936987509034, '958': 0.0012018631763373764, '959': 0, '960': 0, '961': 0, '962': 0, '963': 0, '964': 0, '965': 0, '966': 0, '967': 0, '968': 0, '969': 0, '970': 0, '971': 0, '972': 0, '973': 0, '974': 0, '975': 0, '976': 0, '977': 0, '978': 0, '979': 0, '980': 0, '981': 0, '982': 0, '983': 2.411680951293921e-05, '984': 0, '985': 0, '986': 0, '987': 0, '988': 0, '989': 0, '990': 0, '991': 0.00025344288550139876, '992': 0, '993': 0.0031711792844049186, '994': 0, '995': 0, '996': 0.0007443145621593903, '997': 0, '998': 0, '999': 0.0007704593427730212, '1000': 0, '1001': 0.0031750594499030957, '1002': 0, '1003': 0, '1004': 0, '1005': 0, '1006': 0, '1007': 0, '1008': 0, '1009': 0, '1010': 0, '1011': 0, '1012': 0, '1013': 0, '1014': 0, '1015': 0, '1016': 0.00024325936987509034, '1017': 0, '1018': 0, '1019': 0, '1020': 0, '1021': 0, '1022': 0, '1023': 0, '1024': 0, '1025': 0, '1026': 0, '1027': 0.00014117267278314138, '1028': 0.0005678589350023066, '1029': 0, '1030': 0, '1031': 0, '1032': 0, '1033': 0, '1034': 0, '1035': 0, '1036': 0, '1037': 0, '1038': 0, '1039': 0, '1040': 0, '1041': 0.0014903337149599887, '1042': 0, '1043': 0, '1044': 0, '1045': 0, '1046': 0, '1047': 0, '1048': 0, '1049': 0, '1050': 0, '1051': 0, '1052': 0, '1053': 0, '1054': 0, '1055': 0, '1056': 0, '1057': 0, '1058': 0, '1059': 0, '1060': 0, '1061': 0, '1062': 0, '1063': 0, '1064': 0, '1065': 0.0026312489011391335, '1066': 0, '1067': 0, '1068': 0, '1069': 0.0007442960070478078, '1070': 0, '1071': 0, '1072': 0, '1073': 4.419593606774333e-05, '1074': 0, '1075': 0, '1076': 0, '1077': 0, '1078': 0, '1079': 0, '1080': 0, '1081': 0, '1082': 1.6440664123143278e-06, '1083': 0, '1084': 0, '1085': 0, '1086': 0, '1087': 0, '1088': 0, '1089': 0, '1090': 0.003367222845342319, '1091': 0.003814992472302432, '1092': 0, '1093': 0, '1094': 0, '1095': 0, '1096': 0.00011127447664787847, '1097': 0, '1098': 0, '1099': 0, '1100': 0, '1101': 0, '1102': 0, '1103': 0, '1104': 0, '1105': 0, '1106': 0, '1107': 0, '1108': 0, '1109': 1.846419779912405e-05, '1110': 0, '1111': 0, '1112': 0, '1113': 0.00011127447664787847, '1114': 0, '1115': 0, '1116': 0, '1117': 0, '1118': 0, '1119': 0, '1120': 0, '1121': 0, '1122': 0, '1123': 0, '1124': 0, '1125': 0, '1126': 0, '1127': 0.000147707762335035, '1128': 0, '1129': 0, '1130': 0.007117820924299042, '1131': 4.419593606774333e-05, '1132': 0, '1133': 0, '1134': 0, '1135': 0, '1136': 0, '1137': 0, '1138': 0, '1139': 0, '1140': 0, '1141': 0, '1142': 0, '1143': 0.00011127447664787847, '1144': 0, '1145': 0.00022276386881363134, '1146': 0, '1147': 0, '1148': 0, '1149': 0, '1150': 0, '1151': 0, '1152': 0, '1153': 0, '1154': 0, '1155': 0, '1156': 0, '1157': 0, '1158': 0, '1159': 0.00024325936987509034, '1160': 0, '1161': 0, '1162': 0, '1163': 0, '1164': 0, '1165': 1.4837639435532309e-05, '1166': 0, '1167': 0, '1168': 0, '1169': 0, '1170': 0, '1171': 0, '1172': 0, '1173': 0.002049827947890016, '1174': 0, '1175': 0, '1176': 0, '1177': 0, '1178': 0.00048687154332162857, '1179': 0, '1180': 0, '1181': 0, '1182': 0, '1183': 0, '1184': 0, '1185': 0, '1186': 9.914516049532364e-07, '1187': 0, '1188': 0, '1189': 0, '1190': 0, '1191': 0, '1192': 0, '1193': 0, '1194': 0, '1195': 0, '1196': 0, '1197': 0, '1198': 0, '1199': 0, '1200': 0, '1201': 0, '1202': 0, '1203': 0, '1204': 0, '1205': 0, '1206': 0, '1207': 0.044738242619650266, '1208': 0, '1209': 0, '1210': 0, '1211': 0, '1212': 0, '1213': 0, '1214': 0, '1215': 8.448347093602878e-05, '1216': 0, '1217': 0, '1218': 0, '1219': 0, '1220': 0, '1221': 0, '1222': 0, '1223': 0.0008959941445769546, '1224': 0, '1225': 0, '1226': 0, '1227': 0, '1228': 0.00024325936987509034, '1229': 0, '1230': 0, '1231': 0, '1232': 0.0014903710867657529, '1233': 0, '1234': 0, '1235': 0, '1236': 0, '1237': 0.00113036564811485, '1238': 0, '1239': 0, '1240': 0, '1241': 0, '1242': 0, '1243': 0, '1244': 0, '1245': 0, '1246': 0, '1247': 0, '1248': 0, '1249': 0.0026312489011391335, '1250': 0, '1251': 0, '1252': 0, '1253': 0, '1254': 0, '1255': 0, '1256': 0, '1257': 0, '1258': 0, '1259': 0, '1260': 0, '1261': 0, '1262': 0, '1263': 0.00038190561433396096, '1264': 0, '1265': 0, '1266': 0.004866748053784389, '1267': 0, '1268': 0, '1269': 0, '1270': 0, '1271': 4.826843992057124e-05, '1272': 0, '1273': 0, '1274': 0, '1275': 9.75596525043798e-07, '1276': 0, '1277': 0, '1278': 0, '1279': 0, '1280': 0, '1281': 0, '1282': 0, '1283': 0, '1284': 0.004048461386965664, '1285': 0.00024325936987509034, '1286': 0, '1287': 0, '1288': 0, '1289': 0, '1290': 0, '1291': 0.00326109134096364, '1292': 0, '1293': 0, '1294': 0, '1295': 0.00024325936987509034, '1296': 0.0049520899922336865, '1297': 0, '1298': 0, '1299': 0, '1300': 0, '1301': 0, '1302': 0, '1303': 0, '1304': 0, '1305': 0, '1306': 0, '1307': 0, '1308': 0, '1309': 0, '1310': 0, '1311': 0, '1312': 0, '1313': 0, '1314': 0.00038657095967658964, '1315': 0, '1316': 0, '1317': 4.697788264751559e-05, '1318': 0.0003292747100892738, '1319': 0, '1320': 0, '1321': 0, '1322': 0, '1323': 0, '1324': 0, '1325': 0, '1326': 0, '1327': 0, '1328': 0, '1329': 0, '1330': 0, '1331': 0, '1332': 0, '1333': 0, '1334': 5.576607617149967e-05, '1335': 0, '1336': 0, '1337': 0, '1338': 0, '1339': 0, '1340': 0, '1341': 0, '1342': 0, '1343': 0, '1344': 0, '1345': 0, '1346': 0, '1347': 0, '1348': 0, '1349': 0, '1350': 0, '1351': 0, '1352': 0, '1353': 0.0017517862103399655, '1354': 0, '1355': 0, '1356': 0, '1357': 0, '1358': 0, '1359': 0, '1360': 0, '1361': 0, '1362': 0, '1363': 0, '1364': 0, '1365': 0, '1366': 0, '1367': 0, '1368': 0, '1369': 0, '1370': 0, '1371': 0.0024544883668464463, '1372': 8.304283372221772e-06, '1373': 0, '1374': 0, '1375': 0, '1376': 0, '1377': 0, '1378': 0, '1379': 0, '1380': 0, '1381': 0.00023076689705280094, '1382': 0, '1383': 0, '1384': 0, '1385': 0, '1386': 0, '1387': 0, '1388': 0, '1389': 0, '1390': 0, '1391': 8.859539260970713e-05, '1392': 0, '1393': 0.00015746369845716867, '1394': 0, '1395': 0, '1396': 0, '1397': 0, '1398': 0, '1399': 0, '1400': 0, '1401': 0, '1402': 0, '1403': 0, '1404': 0.00018196218481951985, '1405': 0.0011118555433838376, '1406': 0, '1407': 0, '1408': 0, '1409': 0, '1410': 0, '1411': 0, '1412': 0, '1413': 0, '1414': 0, '1415': 0, '1416': 0, '1417': 0.0016719342931126773, '1418': 5.25335198777325e-06, '1419': 0, '1420': 0.00024325936987509034, '1421': 0.0005624640262174358, '1422': 0, '1423': 0, '1424': 0, '1425': 0, '1426': 0, '1427': 0, '1428': 0, '1429': 0.0005433735138234472, '1430': 0, '1431': 0, '1432': 0.00024325936987509034, '1433': 0, '1434': 0, '1435': 0, '1436': 0, '1437': 0.012079343920961822, '1438': 0, '1439': 0, '1440': 0.005403550551166508, '1441': 0, '1442': 0, '1443': 0, '1444': 0, '1445': 0, '1446': 0, '1447': 0, '1448': 0, '1449': 0, '1450': 0, '1451': 0.0020302659928869756, '1452': 0, '1453': 0, '1454': 0, '1455': 0, '1456': 0, '1457': 0, '1458': 0, '1459': 0, '1460': 0.004701203643729222, '1461': 1.4837639435532309e-05, '1462': 0, '1463': 0.0009025343266775561, '1464': 0, '1465': 0, '1466': 0, '1467': 0, '1468': 0.0007442960070478078, '1469': 0, '1470': 0, '1471': 0, '1472': 0, '1473': 0, '1474': 0, '1475': 0, '1476': 0, '1477': 0, '1478': 0, '1479': 9.75596525043798e-07, '1480': 0, '1481': 0, '1482': 0, '1483': 0, '1484': 0, '1485': 0, '1486': 9.75596525043798e-07, '1487': 0, '1488': 2.9371344302411384e-06, '1489': 0, '1490': 0, '1491': 0, '1492': 0, '1493': 4.697788264751559e-05, '1494': 0, '1495': 1.4837639435532309e-05, '1496': 0.0009025343266775561, '1497': 0, '1498': 0, '1499': 0, '1500': 0, '1501': 0.0009628048322442895, '1502': 0, '1503': 0, '1504': 0, '1505': 0.0009831854199391194, '1506': 0, '1507': 0, '1508': 0, '1509': 0, '1510': 0, '1511': 0, '1512': 0, '1513': 0, '1514': 0, '1515': 0.00024325936987509034, '1516': 0, '1517': 0, '1518': 0, '1519': 0, '1520': 0, '1521': 0, '1522': 0, '1523': 0, '1524': 0, '1525': 0, '1526': 0, '1527': 0, '1528': 0, '1529': 0, '1530': 0, '1531': 0, '1532': 0.0027944424277525767, '1533': 4.697788264751559e-05, '1534': 0, '1535': 0, '1536': 0, '1537': 0, '1538': 0, '1539': 0, '1540': 0, '1541': 0, '1542': 0, '1543': 0, '1544': 0, '1545': 0.00024325936987509034, '1546': 0, '1547': 0, '1548': 0, '1549': 0, '1550': 0, '1551': 9.214159347715697e-06, '1552': 0, '1553': 0, '1554': 0, '1555': 0, '1556': 0, '1557': 0, '1558': 0, '1559': 0, '1560': 0, '1561': 0, '1562': 0, '1563': 0, '1564': 0, '1565': 0, '1566': 0, '1567': 0, '1568': 0, '1569': 0, '1570': 0, '1571': 0, '1572': 0, '1573': 0, '1574': 0, '1575': 0, '1576': 0.00011127447664787847, '1577': 0, '1578': 0, '1579': 0, '1580': 0, '1581': 0, '1582': 0, '1583': 0, '1584': 0, '1585': 0, '1586': 0, '1587': 0, '1588': 0, '1589': 0, '1590': 0, '1591': 0, '1592': 0, '1593': 0, '1594': 0.006003573318389783, '1595': 0, '1596': 0, '1597': 0, '1598': 0, '1599': 0, '1600': 0, '1601': 0, '1602': 0, '1603': 0, '1604': 0, '1605': 0, '1606': 4.697788264751559e-05, '1607': 0, '1608': 0.0017476200502130942, '1609': 0, '1610': 0, '1611': 0, '1612': 0, '1613': 0, '1614': 0, '1615': 0, '1616': 0, '1617': 0, '1618': 0, '1619': 0.00022276386881363134, '1620': 0.00011127447664787847, '1621': 0.0005624640262174358, '1622': 0, '1623': 0, '1624': 0, '1625': 0, '1626': 0, '1627': 0.0003300724970380969, '1628': 0, '1629': 0, '1630': 0, '1631': 0, '1632': 0, '1633': 0, '1634': 0, '1635': 0, '1636': 0, '1637': 0, '1638': 0, '1639': 0, '1640': 0.002033112735469374, '1641': 0, '1642': 0, '1643': 0, '1644': 0, '1645': 0, '1646': 0, '1647': 0, '1648': 0, '1649': 0.0007308374009483905, '1650': 0, '1651': 0, '1652': 0, '1653': 0.001915429015981867, '1654': 0, '1655': 0, '1656': 0, '1657': 0, '1658': 0.016347501662568244, '1659': 0, '1660': 0, '1661': 0, '1662': 0, '1663': 0, '1664': 0, '1665': 0, '1666': 0, '1667': 0.0014680036936858955, '1668': 0, '1669': 0, '1670': 0.01568473170104151, '1671': 2.411680951293921e-05, '1672': 0, '1673': 0, '1674': 0, '1675': 0, '1676': 0, '1677': 0, '1678': 0, '1679': 0, '1680': 0, '1681': 0, '1682': 0, '1683': 0, '1684': 0.00048687154332162857, '1685': 0, '1686': 0.0008298672991981055, '1687': 0, '1688': 0, '1689': 0, '1690': 0, '1691': 0.0006138919180962853, '1692': 0, '1693': 0, '1694': 0, '1695': 0, '1696': 0, '1697': 0, '1698': 0.0012282027460090309, '1699': 0, '1700': 0, '1701': 0, '1702': 0, '1703': 0, '1704': 0, '1705': 0.0010127064907602891, '1706': 0.0007442960070478078, '1707': 0, '1708': 0, '1709': 0, '1710': 0, '1711': 0.0019705183166381967, '1712': 0, '1713': 0, '1714': 0, '1715': 0, '1716': 0, '1717': 0, '1718': 0, '1719': 0.016696105916586407, '1720': 0, '1721': 0, '1722': 0, '1723': 0.0014903337149599887, '1724': 0, '1725': 0, '1726': 0, '1727': 0, '1728': 0, '1729': 0, '1730': 6.850718845612e-05, '1731': 0, '1732': 0, '1733': 0, '1734': 0, '1735': 0.00019277954433455792, '1736': 0.004588362673160578, '1737': 0, '1738': 0, '1739': 4.697788264751559e-05, '1740': 0, '1741': 0, '1742': 0.00043443537095040467, '1743': 0, '1744': 0.0025367857823673694, '1745': 0, '1746': 0, '1747': 0, '1748': 0, '1749': 0.0019195970679664156, '1750': 0, '1751': 0.0014903337149599887, '1752': 0, '1753': 0, '1754': 0.0003292747100892738, '1755': 0, '1756': 0, '1757': 0, '1758': 2.775032586378658e-05, '1759': 0.0007834576483805131, '1760': 0, '1761': 0, '1762': 0, '1763': 1.6172782555605827e-06, '1764': 0, '1765': 0, '1766': 0, '1767': 0, '1768': 3.293317427893009e-06, '1769': 0, '1770': 0, '1771': 0, '1772': 0, '1773': 0, '1774': 0.0036531788937213773, '1775': 0, '1776': 0.000147707762335035, '1777': 0, '1778': 0, '1779': 0.00024325936987509034, '1780': 0, '1781': 0, '1782': 0, '1783': 0.00119863128883099, '1784': 0, '1785': 0.001956003006806932, '1786': 0, '1787': 0, '1788': 0, '1789': 0, '1790': 0.0007442960070478078, '1791': 0, '1792': 0, '1793': 0, '1794': 0, '1795': 0, '1796': 0, '1797': 0, '1798': 0, '1799': 0, '1800': 0, '1801': 0, '1802': 0, '1803': 0, '1804': 0, '1805': 0, '1806': 0, '1807': 0, '1808': 0, '1809': 0, '1810': 2.142412486904157e-05, '1811': 0, '1812': 0, '1813': 0, '1814': 0, '1815': 0.0006193387827917324, '1816': 0, '1817': 0, '1818': 0, '1819': 0, '1820': 0, '1821': 0, '1822': 0, '1823': 0, '1824': 0, '1825': 0, '1826': 0, '1827': 0, '1828': 0, '1829': 0, '1830': 0, '1831': 0, '1832': 1.6440664123143278e-06, '1833': 0, '1834': 0, '1835': 0, '1836': 0, '1837': 0, '1838': 0, '1839': 0, '1840': 0, '1841': 0.0014903337149599887, '1842': 0, '1843': 0, '1844': 0, '1845': 0, '1846': 0, '1847': 0, '1848': 0, '1849': 0, '1850': 0, '1851': 0.00013735374858857784, '1852': 0.00024325936987509034, '1853': 0, '1854': 0, '1855': 0, '1856': 0, '1857': 0, '1858': 0, '1859': 0, '1860': 0, '1861': 0, '1862': 2.5996727848279612e-05, '1863': 0, '1864': 0, '1865': 0, '1866': 0.002049827947890016, '1867': 0.0007442960070478078, '1868': 0, '1869': 0, '1870': 0.00022276386881363134, '1871': 0, '1872': 0, '1873': 0, '1874': 0.00011121058058833087, '1875': 0, '1876': 0, '1877': 0, '1878': 0.0014798442952835204, '1879': 0, '1880': 0, '1881': 2.411680951293921e-05, '1882': 0, '1883': 0, '1884': 0.000147707762335035, '1885': 0, '1886': 1.4837639435532309e-05, '1887': 0, '1888': 0, '1889': 0, '1890': 0, '1891': 0, '1892': 0, '1893': 0.007332021544455485, '1894': 0, '1895': 0.0002862906523685108, '1896': 0, '1897': 0, '1898': 0, '1899': 0, '1900': 0, '1901': 0.0009911951318125028, '1902': 0, '1903': 0, '1904': 0, '1905': 0.00016615750012515126, '1906': 6.8600671941213e-05, '1907': 0, '1908': 0, '1909': 0, '1910': 0, '1911': 0, '1912': 0, '1913': 0, '1914': 1.6440664123143278e-06, '1915': 0, '1916': 0.04796841240887905, '1917': 0, '1918': 0, '1919': 0, '1920': 0, '1921': 0, '1922': 0.0005788859956241575, '1923': 0, '1924': 0, '1925': 0, '1926': 0.000124774254975582, '1927': 0.00011127447664787847, '1928': 0, '1929': 0.00043443537095040467, '1930': 0, '1931': 0, '1932': 0, '1933': 0, '1934': 0, '1935': 0, '1936': 0, '1937': 0, '1938': 0, '1939': 0, '1940': 0, '1941': 0, '1942': 0, '1943': 1.970482016723583e-06, '1944': 0, '1945': 0, '1946': 0, '1947': 0, '1948': 0, '1949': 0, '1950': 0, '1951': 0, '1952': 0, '1953': 0.010298848280624016, '1954': 0, '1955': 0, '1956': 0, '1957': 0, '1958': 0, '1959': 0, '1960': 0, '1961': 0, '1962': 0.00024325936987509034, '1963': 0, '1964': 0, '1965': 0, '1966': 0, '1967': 0, '1968': 0, '1969': 0, '1970': 0, '1971': 0, '1972': 0, '1973': 0, '1974': 0.00011127447664787847, '1975': 0, '1976': 0, '1977': 0, '1978': 0, '1979': 0, '1980': 0.0020518899581370535, '1981': 0, '1982': 0, '1983': 2.411680951293921e-05, '1984': 0, '1985': 0, '1986': 0, '1987': 0, '1988': 0, '1989': 0, '1990': 0.0042936747103467544, '1991': 0.010859555773136763, '1992': 0.013680309522538998, '1993': 0.001956003006806932, '1994': 0, '1995': 0, '1996': 0, '1997': 0, '1998': 0, '1999': 0, '2000': 0, '2001': 0, '2002': 0.0011335590547031428, '2003': 1.4837639435532309e-05, '2004': 0, '2005': 0, '2006': 0, '2007': 0, '2008': 0, '2009': 0, '2010': 0, '2011': 0.0007442960070478078, '2012': 1.6440664123143278e-06, '2013': 0, '2014': 0, '2015': 0, '2016': 0, '2017': 0, '2018': 0, '2019': 0.0007308374009483905, '2020': 0, '2021': 0, '2022': 0, '2023': 0, '2024': 0, '2025': 0, '2026': 0.0033611498946657216, '2027': 0, '2028': 0, '2029': 0, '2030': 0, '2031': 0, '2032': 0, '2033': 0, '2034': 0, '2035': 0, '2036': 0, '2037': 0, '2038': 0, '2039': 0, '2040': 0, '2041': 0.012146735001063827, '2042': 0, '2043': 0, '2044': 0, '2045': 0.0007442960070478078, '2046': 0, '2047': 0, '2048': 0, '2049': 0.00012644371673735632, '2050': 0, '2051': 0, '2052': 0.00012644371673735632, '2053': 0, '2054': 0, '2055': 0, '2056': 0, '2057': 0, '2058': 0, '2059': 0, '2060': 0, '2061': 0, '2062': 0, '2063': 0, '2064': 0, '2065': 0.01297732228361561, '2066': 0, '2067': 0, '2068': 0.003548043929683779, '2069': 0, '2070': 0, '2071': 0, '2072': 0, '2073': 0.0013135295352026898, '2074': 0, '2075': 0, '2076': 0, '2077': 0, '2078': 0, '2079': 0, '2080': 0, '2081': 0, '2082': 0, '2083': 0, '2084': 0, '2085': 0, '2086': 0, '2087': 0, '2088': 0, '2089': 0, '2090': 0.00024325936987509034, '2091': 0, '2092': 0, '2093': 0, '2094': 0, '2095': 0, '2096': 0.00011127447664787847, '2097': 0, '2098': 0, '2099': 0, '2100': 0, '2101': 0, '2102': 0, '2103': 0, '2104': 0, '2105': 0, '2106': 0, '2107': 0, '2108': 0, '2109': 0, '2110': 0, '2111': 0, '2112': 0, '2113': 0, '2114': 0, '2115': 0, '2116': 0, '2117': 0, '2118': 0, '2119': 6.841382371081405e-05, '2120': 0, '2121': 0, '2122': 0, '2123': 0, '2124': 0, '2125': 0.001915429015981867, '2126': 0, '2127': 0, '2128': 0.0003344688332624547, '2129': 0, '2130': 0, '2131': 0, '2132': 0, '2133': 0.00048687154332162857, '2134': 0, '2135': 0, '2136': 0, '2137': 0, '2138': 0, '2139': 0, '2140': 0, '2141': 0.0003922322670779705, '2142': 0, '2143': 9.75596525043798e-07, '2144': 0, '2145': 0, '2146': 0, '2147': 0, '2148': 0, '2149': 0, '2150': 0, '2151': 0, '2152': 0, '2153': 0, '2154': 0, '2155': 0, '2156': 0.0007862581764261933, '2157': 0, '2158': 0.00011127447664787847, '2159': 0, '2160': 0, '2161': 0, '2162': 0, '2163': 0, '2164': 0, '2165': 0, '2166': 0.0009521908913427723, '2167': 0.0003292747100892738, '2168': 0, '2169': 0, '2170': 0, '2171': 0, '2172': 0, '2173': 0, '2174': 4.419593606774333e-05, '2175': 0, '2176': 0, '2177': 0, '2178': 0, '2179': 0, '2180': 0.006452222868454559, '2181': 0, '2182': 0.0009628048322442895, '2183': 0, '2184': 0, '2185': 0.0016861004938311082, '2186': 0.0021141092152009906, '2187': 0.00022276386881363134, '2188': 0, '2189': 0, '2190': 0, '2191': 0, '2192': 0, '2193': 0, '2194': 0, '2195': 0.00011127447664787847, '2196': 0.00011127447664787847, '2197': 0, '2198': 0, '2199': 0, '2200': 0.0009751578266891523, '2201': 0, '2202': 0.0003581229102609482, '2203': 0, '2204': 0, '2205': 0, '2206': 0, '2207': 0, '2208': 0, '2209': 0.004824211506417941, '2210': 0.0050858601538665785, '2211': 0, '2212': 0, '2213': 0, '2214': 0, '2215': 0, '2216': 0, '2217': 0, '2218': 0.0003646150918893016, '2219': 0.016347501662568244, '2220': 0, '2221': 0, '2222': 0, '2223': 0, '2224': 0, '2225': 0, '2226': 0, '2227': 0.0002432290039104989, '2228': 0, '2229': 0, '2230': 0, '2231': 0, '2232': 0, '2233': 0, '2234': 0, '2235': 0, '2236': 0, '2237': 0, '2238': 0, '2239': 0, '2240': 0, '2241': 0, '2242': 0, '2243': 0, '2244': 0, '2245': 0, '2246': 0, '2247': 0, '2248': 0, '2249': 0, '2250': 0.00023769161064129832, '2251': 0, '2252': 0, '2253': 0, '2254': 0, '2255': 0.00024325936987509034, '2256': 0, '2257': 0, '2258': 0.001915429015981867, '2259': 0, '2260': 0, '2261': 0, '2262': 0, '2263': 0, '2264': 0, '2265': 0, '2266': 0, '2267': 0, '2268': 0, '2269': 0, '2270': 0, '2271': 0, '2272': 0, '2273': 0, '2274': 0, '2275': 0, '2276': 0, '2277': 0, '2278': 0, '2279': 0.0002552157673528727, '2280': 0, '2281': 0, '2282': 0, '2283': 0, '2284': 0, '2285': 0.00024325936987509034, '2286': 0, '2287': 0, '2288': 0.006183789103232255, '2289': 0, '2290': 0, '2291': 0, '2292': 0, '2293': 0, '2294': 0, '2295': 0, '2296': 0, '2297': 0, '2298': 0, '2299': 0, '2300': 0, '2301': 0, '2302': 0, '2303': 0, '2304': 0, '2305': 0, '2306': 0, '2307': 0, '2308': 0, '2309': 0, '2310': 0, '2311': 0.0013135295352026898, '2312': 0, '2313': 0, '2314': 0, '2315': 0, '2316': 0, '2317': 0, '2318': 0, '2319': 0, '2320': 0, '2321': 0, '2322': 0, '2323': 0, '2324': 0, '2325': 0, '2326': 0, '2327': 0, '2328': 0, '2329': 0, '2330': 0, '2331': 0, '2332': 0, '2333': 0, '2334': 0, '2335': 3.293317427893009e-06, '2336': 0, '2337': 0, '2338': 0, '2339': 0, '2340': 0, '2341': 0, '2342': 0, '2343': 0, '2344': 0.0013135295352026898, '2345': 0, '2346': 0, '2347': 0, '2348': 0, '2349': 0, '2350': 0, '2351': 0, '2352': 1.4837639435532309e-05, '2353': 0, '2354': 0, '2355': 0.0012230953775607457, '2356': 0, '2357': 0, '2358': 0, '2359': 0, '2360': 0, '2361': 0, '2362': 0, '2363': 0, '2364': 0, '2365': 0, '2366': 0, '2367': 0, '2368': 0, '2369': 0, '2370': 0, '2371': 0, '2372': 0, '2373': 0, '2374': 0, '2375': 0.00024325936987509034, '2376': 0, '2377': 0, '2378': 0, '2379': 0, '2380': 0, '2381': 0, '2382': 4.050964392534473e-05, '2383': 0, '2384': 0, '2385': 0, '2386': 0, '2387': 0, '2388': 6.513245905300703e-08, '2389': 0.0012147416291788413, '2390': 0, '2391': 0.00011127447664787847, '2392': 0, '2393': 0, '2394': 0, '2395': 0, '2396': 0, '2397': 0, '2398': 0, '2399': 0, '2400': 0.0007442960070478078, '2401': 0, '2402': 0.009614827734265398, '2403': 0.0007442960070478078, '2404': 0, '2405': 0.00022276386881363134, '2406': 0, '2407': 0, '2408': 0, '2409': 0, '2410': 0, '2411': 0, '2412': 0, '2413': 0, '2414': 0, '2415': 0.000562320885278789, '2416': 0, '2417': 0, '2418': 0, '2419': 0, '2420': 0.0007308374009483905, '2421': 0, '2422': 0, '2423': 0, '2424': 0, '2425': 0, '2426': 0, '2427': 0, '2428': 0.0009628048322442895, '2429': 0, '2430': 0, '2431': 0.00011127447664787847, '2432': 0, '2433': 0, '2434': 0, '2435': 0, '2436': 0, '2437': 0, '2438': 0, '2439': 0, '2440': 0, '2441': 0, '2442': 0, '2443': 0, '2444': 0, '2445': 0.0003344688332624547, '2446': 0, '2447': 0, '2448': 0.00024325936987509034, '2449': 0, '2450': 0, '2451': 0, '2452': 0.00024325936987509034, '2453': 0, '2454': 0, '2455': 0, '2456': 0.029716044987260284, '2457': 0, '2458': 0, '2459': 0, '2460': 1.6440664123143278e-06, '2461': 0, '2462': 0, '2463': 0, '2464': 0, '2465': 0, '2466': 0, '2467': 0, '2468': 0, '2469': 0, '2470': 0, '2471': 0, '2472': 0, '2473': 0, '2474': 1.4837639435532309e-05, '2475': 0.00024324419810963326, '2476': 0, '2477': 0, '2478': 0, '2479': 0, '2480': 0, '2481': 0, '2482': 0, '2483': 0, '2484': 0, '2485': 0, '2486': 0, '2487': 1.4837639435532309e-05, '2488': 0, '2489': 0, '2490': 0, '2491': 0, '2492': 0, '2493': 0.001915429015981867, '2494': 0, '2495': 0, '2496': 0, '2497': 0, '2498': 0, '2499': 0, '2500': 0, '2501': 0, '2502': 0, '2503': 0.0014752654497348782, '2504': 0, '2505': 0, '2506': 0.00014705880866570703, '2507': 0, '2508': 0, '2509': 0, '2510': 0, '2511': 0, '2512': 0, '2513': 0, '2514': 0, '2515': 0, '2516': 9.914516049532364e-07, '2517': 0, '2518': 0, '2519': 0, '2520': 0, '2521': 4.697788264751559e-05, '2522': 0, '2523': 0, '2524': 0, '2525': 0, '2526': 9.75596525043798e-07, '2527': 0, '2528': 0, '2529': 0.00636031031241161, '2530': 0, '2531': 0, '2532': 0, '2533': 0, '2534': 0, '2535': 0, '2536': 0, '2537': 0, '2538': 0, '2539': 0, '2540': 0, '2541': 4.6946500948388776e-05, '2542': 0, '2543': 0, '2544': 0, '2545': 0, '2546': 0, '2547': 0, '2548': 0, '2549': 0, '2550': 0, '2551': 0, '2552': 0, '2553': 0, '2554': 0, '2555': 0, '2556': 0, '2557': 0.0009628048322442895, '2558': 0, '2559': 0, '2560': 0, '2561': 0, '2562': 0.0013135295352026898, '2563': 0, '2564': 0, '2565': 0, '2566': 0, '2567': 0, '2568': 0, '2569': 0, '2570': 0.0003919016579574672, '2571': 0, '2572': 0, '2573': 0, '2574': 0, '2575': 0, '2576': 0.00043443537095040467, '2577': 0, '2578': 0, '2579': 0.002734146353166332, '2580': 0, '2581': 0, '2582': 0, '2583': 0, '2584': 0.00048687154332162857, '2585': 0, '2586': 0, '2587': 0, '2588': 0, '2589': 0, '2590': 0, '2591': 0, '2592': 0, '2593': 0, '2594': 0, '2595': 0, '2596': 0, '2597': 0, '2598': 0, '2599': 0, '2600': 0, '2601': 0, '2602': 0, '2603': 0, '2604': 0, '2605': 0, '2606': 0.00011127447664787847, '2607': 0, '2608': 0, '2609': 0, '2610': 0, '2611': 0.003367222845342319, '2612': 0, '2613': 0, '2614': 0, '2615': 0, '2616': 0, '2617': 0, '2618': 0, '2619': 0, '2620': 0.013924133139005798, '2621': 0, '2622': 9.406674365931172e-05, '2623': 0, '2624': 0, '2625': 0, '2626': 0, '2627': 0, '2628': 0, '2629': 0, '2630': 0.008203233516857472, '2631': 0.00011127447664787847, '2632': 9.406674365931172e-05, '2633': 0, '2634': 0, '2635': 0, '2636': 2.9973111789599095e-05, '2637': 0, '2638': 0, '2639': 0.0007442960070478078, '2640': 0, '2641': 0, '2642': 0, '2643': 0.020767065190717336, '2644': 0, '2645': 0.00019412407987187035, '2646': 0, '2647': 0, '2648': 0, '2649': 0, '2650': 0, '2651': 0, '2652': 0.0044659834248810685, '2653': 0, '2654': 0.003381420880407854, '2655': 0, '2656': 0, '2657': 0, '2658': 0, '2659': 0, '2660': 0, '2661': 0, '2662': 0, '2663': 0, '2664': 0, '2665': 0, '2666': 0, '2667': 0, '2668': 0, '2669': 0, '2670': 0, '2671': 0, '2672': 0, '2673': 0, '2674': 0, '2675': 0, '2676': 0, '2677': 0, '2678': 0, '2679': 0, '2680': 0, '2681': 0, '2682': 0, '2683': 0, '2684': 0.00018959706438275348, '2685': 0.00024074845323917497, '2686': 0, '2687': 0, '2688': 0, '2689': 0, '2690': 0.0007442960070478078, '2691': 0, '2692': 0.00011127447664787847, '2693': 0, '2694': 0, '2695': 0, '2696': 0, '2697': 0, '2698': 0, '2699': 0, '2700': 0.00024325936987509034, '2701': 0, '2702': 0, '2703': 0, '2704': 0, '2705': 0, '2706': 0, '2707': 0, '2708': 0.0003292747100892738, '2709': 0, '2710': 0, '2711': 0, '2712': 0, '2713': 0, '2714': 0, '2715': 0, '2716': 9.914516049532364e-07, '2717': 0, '2718': 0.00048687154332162857, '2719': 0, '2720': 0, '2721': 0, '2722': 0, '2723': 0, '2724': 0, '2725': 0, '2726': 0.0008039009678937937, '2727': 0, '2728': 0, '2729': 0, '2730': 0, '2731': 0, '2732': 0, '2733': 0, '2734': 0, '2735': 0, '2736': 0, '2737': 0, '2738': 0, '2739': 0, '2740': 0, '2741': 0, '2742': 0, '2743': 0, '2744': 0, '2745': 0, '2746': 0, '2747': 0, '2748': 0, '2749': 0.00024325936987509034, '2750': 0, '2751': 0, '2752': 0, '2753': 0, '2754': 0, '2755': 9.214159347715697e-06, '2756': 0, '2757': 0, '2758': 0, '2759': 0, '2760': 0.00011127447664787847, '2761': 0, '2762': 0, '2763': 0, '2764': 0, '2765': 0, '2766': 0, '2767': 0, '2768': 0, '2769': 0, '2770': 0, '2771': 0, '2772': 0, '2773': 0, '2774': 0, '2775': 0, '2776': 0, '2777': 0, '2778': 0, '2779': 0, '2780': 0, '2781': 0, '2782': 0, '2783': 0, '2784': 0.00024325936987509034, '2785': 0, '2786': 0, '2787': 0, '2788': 0, '2789': 0, '2790': 0, '2791': 0, '2792': 0, '2793': 0.0009627986610173864, '2794': 0.000660041620996807, '2795': 0, '2796': 0, '2797': 0, '2798': 0.0029679214131850314, '2799': 0, '2800': 0, '2801': 0, '2802': 0, '2803': 9.214159347715697e-06, '2804': 0, '2805': 0, '2806': 0, '2807': 0, '2808': 0.0003292747100892738, '2809': 0, '2810': 0, '2811': 0, '2812': 0, '2813': 0.0006608261851115864, '2814': 0, '2815': 0.0029891048824093923, '2816': 0, '2817': 0, '2818': 0, '2819': 0, '2820': 0, '2821': 0.00011127447664787847, '2822': 0, '2823': 0, '2824': 0, '2825': 0, '2826': 0, '2827': 0, '2828': 0, '2829': 0, '2830': 0, '2831': 0, '2832': 0, '2833': 0, '2834': 0, '2835': 0, '2836': 0, '2837': 0, '2838': 0, '2839': 0, '2840': 0, '2841': 0, '2842': 0, '2843': 0, '2844': 0, '2845': 0, '2846': 0, '2847': 0, '2848': 0, '2849': 0.0025367857823673694, '2850': 0, '2851': 0, '2852': 0, '2853': 0, '2854': 0, '2855': 0, '2856': 0, '2857': 0, '2858': 0, '2859': 0, '2860': 0, '2861': 0.00022269996634468068, '2862': 0, '2863': 0, '2864': 0, '2865': 0, '2866': 0, '2867': 0, '2868': 0, '2869': 0, '2870': 0, '2871': 0, '2872': 0, '2873': 0, '2874': 0, '2875': 0, '2876': 0, '2877': 0.00028297244015738324, '2878': 0.0007308374009483905, '2879': 0, '2880': 0, '2881': 0, '2882': 0.00578400219054959, '2883': 4.697788264751559e-05, '2884': 0, '2885': 2.017102484503683e-07, '2886': 0, '2887': 0, '2888': 0, '2889': 0, '2890': 0, '2891': 0, '2892': 0, '2893': 0, '2894': 0, '2895': 0, '2896': 0, '2897': 0, '2898': 0, '2899': 0.00024325936987509034, '2900': 0, '2901': 0, '2902': 0, '2903': 0, '2904': 0, '2905': 0, '2906': 0, '2907': 0.028976439123925328, '2908': 0, '2909': 0.0027944424277525767, '2910': 0, '2911': 0, '2912': 0.00024324419810963326, '2913': 0, '2914': 0, '2915': 0, '2916': 0, '2917': 0.000147707762335035, '2918': 0, '2919': 0, '2920': 0, '2921': 0, '2922': 0, '2923': 0, '2924': 0, '2925': 0.00048687154332162857, '2926': 0, '2927': 0, '2928': 0, '2929': 0, '2930': 0, '2931': 0, '2932': 0, '2933': 0, '2934': 0, '2935': 0, '2936': 0, '2937': 0, '2938': 0, '2939': 0, '2940': 0, '2941': 0, '2942': 0.0032287365700243704, '2943': 0, '2944': 0, '2945': 0, '2946': 0, '2947': 0, '2948': 0, '2949': 0, '2950': 0, '2951': 0, '2952': 0, '2953': 0, '2954': 0, '2955': 0, '2956': 0, '2957': 0, '2958': 0, '2959': 0, '2960': 0, '2961': 0.00048687154332162857, '2962': 0, '2963': 0.0013153482487291823, '2964': 0, '2965': 0, '2966': 0, '2967': 0, '2968': 0.0031711792844049186, '2969': 0, '2970': 0.0009628048322442895, '2971': 0.00024325936987509034, '2972': 0, '2973': 0, '2974': 0, '2975': 9.400392480166071e-05, '2976': 0, '2977': 0, '2978': 0, '2979': 0, '2980': 0, '2981': 0, '2982': 0, '2983': 0, '2984': 0, '2985': 0, '2986': 0.001219833707819232, '2987': 0, '2988': 0, '2989': 0.00024325936987509034, '2990': 0, '2991': 0, '2992': 0, '2993': 0, '2994': 0, '2995': 0, '2996': 0, '2997': 0, '2998': 0, '2999': 0, '3000': 0, '3001': 0, '3002': 0, '3003': 0, '3004': 0, '3005': 0, '3006': 0, '3007': 0, '3008': 0, '3009': 0.00024325936987509034, '3010': 0, '3011': 0, '3012': 0, '3013': 0, '3014': 0, '3015': 0, '3016': 0, '3017': 0, '3018': 0, '3019': 0, '3020': 0, '3021': 0, '3022': 0, '3023': 0, '3024': 0.00019412407987187035, '3025': 0, '3026': 3.514341187953792e-05, '3027': 0, '3028': 0, '3029': 0, '3030': 0, '3031': 0, '3032': 0, '3033': 0, '3034': 0, '3035': 0, '3036': 0, '3037': 0, '3038': 0, '3039': 0, '3040': 0, '3041': 0, '3042': 0, '3043': 0, '3044': 0, '3045': 0.0007454424046742624, '3046': 0, '3047': 0, '3048': 0, '3049': 0, '3050': 0, '3051': 0, '3052': 0, '3053': 0, '3054': 0.00024325936987509034, '3055': 0, '3056': 6.935023660671136e-05, '3057': 0, '3058': 0, '3059': 0, '3060': 0, '3061': 0, '3062': 0.0007442960070478078, '3063': 0, '3064': 0, '3065': 0, '3066': 0, '3067': 0, '3068': 0, '3069': 0, '3070': 0, '3071': 0.022285711954853682, '3072': 0, '3073': 0, '3074': 0.00043412845944696635, '3075': 0.0002951495060456925, '3076': 0, '3077': 0, '3078': 0, '3079': 0, '3080': 0, '3081': 0, '3082': 0, '3083': 0, '3084': 0, '3085': 0, '3086': 0.0020591595211530817, '3087': 0.002640471917302523, '3088': 0, '3089': 0, '3090': 0, '3091': 0.0013617926119805946, '3092': 0, '3093': 0, '3094': 0, '3095': 0, '3096': 0, '3097': 0, '3098': 0, '3099': 0, '3100': 0, '3101': 0.00011124253938205243, '3102': 0, '3103': 0, '3104': 0, '3105': 0, '3106': 0, '3107': 0, '3108': 2.175954182122304e-08, '3109': 0.0009225270147625139, '3110': 0, '3111': 0, '3112': 0, '3113': 0, '3114': 0, '3115': 0, '3116': 0, '3117': 0, '3118': 0, '3119': 4.337692842623831e-06, '3120': 0, '3121': 0, '3122': 0, '3123': 0, '3124': 0, '3125': 0, '3126': 0, '3127': 0, '3128': 3.2001039698925605e-06, '3129': 0, '3130': 0, '3131': 0.001051357760233279, '3132': 0, '3133': 0, '3134': 0, '3135': 0, '3136': 0, '3137': 0, '3138': 0, '3139': 0, '3140': 0, '3141': 0, '3142': 0, '3143': 0, '3144': 0, '3145': 0, '3146': 4.697788264751559e-05, '3147': 0.00019412407987187035, '3148': 0, '3149': 0, '3150': 0.0009628048322442895, '3151': 8.621188583017608e-06, '3152': 0, '3153': 0, '3154': 0, '3155': 0, '3156': 0, '3157': 0, '3158': 0, '3159': 0, '3160': 0, '3161': 0, '3162': 0, '3163': 0, '3164': 0, '3165': 0, '3166': 0, '3167': 0.0007442960070478078, '3168': 0, '3169': 0, '3170': 0, '3171': 0, '3172': 0, '3173': 0, '3174': 0, '3175': 0, '3176': 0, '3177': 0.006480897816003313, '3178': 0.00011224773170737096, '3179': 0, '3180': 0, '3181': 0, '3182': 0, '3183': 0, '3184': 0, '3185': 7.460040748837786e-05, '3186': 0.0013135295352026898, '3187': 0, '3188': 0, '3189': 0, '3190': 4.6431701159083745e-05, '3191': 0.0017541301442662487, '3192': 0, '3193': 0, '3194': 0, '3195': 0, '3196': 0, '3197': 0, '3198': 0.00011127447664787847, '3199': 0, '3200': 0, '3201': 0, '3202': 0, '3203': 0, '3204': 0, '3205': 0, '3206': 0, '3207': 0, '3208': 0, '3209': 0, '3210': 0, '3211': 0, '3212': 0, '3213': 0, '3214': 0, '3215': 0, '3216': 0, '3217': 0, '3218': 0, '3219': 0, '3220': 0, '3221': 0, '3222': 0, '3223': 0, '3224': 0, '3225': 0, '3226': 0, '3227': 0, '3228': 0, '3229': 0, '3230': 0, '3231': 0, '3232': 0, '3233': 0, '3234': 0, '3235': 0, '3236': 0, '3237': 0.00048687154332162857, '3238': 0, '3239': 0, '3240': 0, '3241': 0, '3242': 0, '3243': 0, '3244': 0.0032287365700243704, '3245': 0, '3246': 0, '3247': 0, '3248': 0, '3249': 0, '3250': 0, '3251': 0, '3252': 0, '3253': 0.0028109999815191756, '3254': 0, '3255': 0, '3256': 0, '3257': 0, '3258': 0, '3259': 0.01210369702220657, '3260': 0, '3261': 0.03308748974036789, '3262': 0, '3263': 0, '3264': 0, '3265': 0.0002953390591477151, '3266': 2.411680951293921e-05, '3267': 0, '3268': 0, '3269': 0, '3270': 0, '3271': 0, '3272': 0, '3273': 0, '3274': 0, '3275': 0, '3276': 0, '3277': 0, '3278': 0, '3279': 0, '3280': 0, '3281': 0, '3282': 0.0050858601538665785, '3283': 0.00011127447664787847, '3284': 0, '3285': 0, '3286': 0, '3287': 0, '3288': 0, '3289': 0, '3290': 0, '3291': 0, '3292': 0, '3293': 0, '3294': 0, '3295': 0, '3296': 0, '3297': 0, '3298': 0, '3299': 0, '3300': 0, '3301': 0, '3302': 0, '3303': 0.0012840224428913177, '3304': 0, '3305': 0, '3306': 0, '3307': 0, '3308': 0, '3309': 0, '3310': 0, '3311': 0, '3312': 0, '3313': 0, '3314': 0.007117820924299042, '3315': 0, '3316': 0, '3317': 0, '3318': 0.0012814754412816725, '3319': 0.0008809042001067719, '3320': 0, '3321': 0, '3322': 9.613512377798901e-05, '3323': 0, '3324': 0, '3325': 0, '3326': 0, '3327': 0.0009156751429343156, '3328': 2.4236596731512148e-06, '3329': 0, '3330': 0, '3331': 2.411680951293921e-05, '3332': 0, '3333': 0, '3334': 0, '3335': 0, '3336': 0, '3337': 0, '3338': 0, '3339': 0, '3340': 0.003019902766823253, '3341': 0, '3342': 0, '3343': 0, '3344': 0, '3345': 0, '3346': 0, '3347': 0.0032448372413158726, '3348': 0, '3349': 0, '3350': 0, '3351': 0, '3352': 0, '3353': 0, '3354': 0, '3355': 1.6440664123143278e-06, '3356': 0.00011127447664787847, '3357': 0, '3358': 0, '3359': 0.006065809690828706, '3360': 0.00033311647879876827, '3361': 0, '3362': 0, '3363': 0, '3364': 0, '3365': 0, '3366': 0.0027944424277525767, '3367': 0, '3368': 0, '3369': 0, '3370': 0, '3371': 0, '3372': 0.00011127447664787847, '3373': 0, '3374': 0, '3375': 0, '3376': 0, '3377': 0, '3378': 0, '3379': 0.0007636882710232142, '3380': 0.00015993167756096495, '3381': 0, '3382': 0, '3383': 1.6440664123143278e-06, '3384': 0.03134154543255381, '3385': 0, '3386': 0, '3387': 0, '3388': 0, '3389': 0, '3390': 0, '3391': 0, '3392': 0, '3393': 0, '3394': 0, '3395': 0.001157705578224722, '3396': 0, '3397': 0, '3398': 0, '3399': 0, '3400': 0, '3401': 0, '3402': 0, '3403': 0.030322235720795995, '3404': 0, '3405': 0, '3406': 0, '3407': 0, '3408': 0, '3409': 0, '3410': 0, '3411': 0.00687577981504728, '3412': 0.0022224299763266126, '3413': 0, '3414': 0, '3415': 0.0004786852828187789, '3416': 0, '3417': 0, '3418': 0, '3419': 0, '3420': 0, '3421': 0.005155846325262068, '3422': 0, '3423': 0.00023076689705280094, '3424': 0, '3425': 9.406674365931172e-05, '3426': 0, '3427': 0, '3428': 0, '3429': 0, '3430': 0, '3431': 0, '3432': 0, '3433': 0, '3434': 0, '3435': 0.0009044875157873486, '3436': 0, '3437': 0.000147707762335035, '3438': 0, '3439': 0, '3440': 0, '3441': 0.002281272624895057, '3442': 1.0174225371376998e-05, '3443': 0, '3444': 0, '3445': 0, '3446': 0, '3447': 0, '3448': 0.0006172215624070999, '3449': 0, '3450': 1.3275951827593615e-05, '3451': 0, '3452': 0, '3453': 0, '3454': 0, '3455': 0, '3456': 0, '3457': 0}

    mi_scores = dict(sorted(mi_scores.items(), key=lambda item: item[1]))

    spam = train_x.loc[train_x['class'] == 1]
    ham = train_x.loc[train_x['class'] == 0]
    spamCount = len(spam.index)
    hamCount = len(ham.index)
    total_email = spamCount + hamCount

    # calculate pi and take log
    pi_spam = np.log2(spamCount / total_email)
    pi_ham = np.log2(hamCount / total_email)

    #######################################FIRST STEP#######################################
    start_time = time.time()
    first = list(mi_scores.keys())[-100:]

    train_x_first = pd.DataFrame()
    for x in first:
        train_x_first[x] = train_x[x]

    train_x_first['class'] = train_y
    spam_first = train_x_first.loc[train_x_first['class'] == 1]
    ham_first = train_x_first.loc[train_x_first['class'] == 0]

    spam_probs = list()
    for column in spam_first.iloc[:, :-1]:
        tot = 0
        for r in spam_first[column]:
            if r > 0:
                tot += 1
        prob = tot / spamCount
        spam_probs.append(prob)

    ham_probs = list()
    for column in ham_first.iloc[:, :-1]:
        tot = 0
        for r in ham_first[column]:
            if r > 0:
                tot += 1
        prob = tot / hamCount
        ham_probs.append(prob)
    theta_spam = spam_probs
    theta_ham = ham_probs

    end_time = time.time()
    print("train time:", end_time - start_time, "seconds")
    # train end
    # test start

    conf = np.array([[0, 0], [0, 0]])

    # Copy test_x because we will change it
    test_x_cp = test_x.copy()

    pred = []
    for index, row in test_x_cp.iterrows():
        i = 0

        yham = 1
        yspam = 1
        for f in first:
            x = row[f]
            if row[f] > 0:
                x = 1

            yspam *= (x * theta_spam[i] + (1 - x) * (1 - theta_spam[i]))
            yham *= (x * theta_ham[i] + (1 - x) * (1 - theta_ham[i]))
            i += 1

        yham = np.log2(yham) if yham != 0 else -math.inf
        yham += pi_ham
        yspam = np.log2(yspam) if yspam != 0 else -math.inf
        yspam += pi_spam
        pred.append(1 if yspam > yham else 0)

    TP = 0
    FP = 0
    TN = 0
    FN = 0
    i = 0
    confusion_matrix = np.array([[0, 0], [0, 0]])

    for prediction in pred:
        if prediction == 0 and test_y[i][0] == 0:
            TN += 1
        elif prediction == 0 and test_y[i][0] == 1:
            FN += 1
        elif prediction == 1 and test_y[i][0] == 1:
            TP += 1
        elif prediction == 1 and test_y[i][0] == 0:
            FP += 1
        i += 1

    confusion_matrix[0][0] = TP
    confusion_matrix[0][1] = FN
    confusion_matrix[1][0] = FP
    confusion_matrix[1][1] = TN

    acc = (TP + TN) / (TP + TN + FP + FN)
    print("Accuracy:", acc * 100)
    print("Confusion Matrix:")
    print(confusion_matrix)

    #######################################SECOND STEP#######################################
    start_time = time.time()
    second = list(mi_scores.keys())[-200:]

    train_x_second = pd.DataFrame()
    for x in second:
        train_x_second[x] = train_x[x]

    train_x_second['class'] = train_y
    spam_second = train_x_second.loc[train_x_second['class'] == 1]
    ham_second = train_x_second.loc[train_x_second['class'] == 0]

    spam_probs = list()
    for column in spam_second.iloc[:, :-1]:
        tot = 0
        for r in spam_second[column]:
            if r > 0:
                tot += 1
        prob = tot / spamCount
        spam_probs.append(prob)

    ham_probs = list()
    for column in ham_second.iloc[:, :-1]:
        tot = 0
        for r in ham_second[column]:
            if r > 0:
                tot += 1
        prob = tot / hamCount
        ham_probs.append(prob)
    theta_spam = spam_probs
    theta_ham = ham_probs

    end_time = time.time()
    print("train time:", end_time - start_time, "seconds")
    # train end
    # test start

    conf = np.array([[0, 0], [0, 0]])

    # Copy test_x because we will change it
    test_x_cp = test_x.copy()

    pred = []
    for index, row in test_x_cp.iterrows():
        i = 0

        yham = 1
        yspam = 1
        for f in second:
            x = row[f]
            if row[f] > 0:
                x = 1

            yspam *= (x * theta_spam[i] + (1 - x) * (1 - theta_spam[i]))
            yham *= (x * theta_ham[i] + (1 - x) * (1 - theta_ham[i]))
            i += 1

        yham = np.log2(yham) if yham != 0 else -math.inf
        yham += pi_ham
        yspam = np.log2(yspam) if yspam != 0 else -math.inf
        yspam += pi_spam
        pred.append(1 if yspam > yham else 0)

    TP = 0
    FP = 0
    TN = 0
    FN = 0
    i = 0
    confusion_matrix = np.array([[0, 0], [0, 0]])

    for prediction in pred:
        if prediction == 0 and test_y[i][0] == 0:
            TN += 1
        elif prediction == 0 and test_y[i][0] == 1:
            FN += 1
        elif prediction == 1 and test_y[i][0] == 1:
            TP += 1
        elif prediction == 1 and test_y[i][0] == 0:
            FP += 1
        i += 1

    confusion_matrix[0][0] = TP
    confusion_matrix[0][1] = FN
    confusion_matrix[1][0] = FP
    confusion_matrix[1][1] = TN

    acc = (TP + TN) / (TP + TN + FP + FN)
    print("Accuracy:", acc * 100)
    print("Confusion Matrix:")
    print(confusion_matrix)

    #######################################THIRD STEP#######################################
    start_time = time.time()
    third = list(mi_scores.keys())[-300:]

    train_x_third = pd.DataFrame()
    for x in third:
        train_x_third[x] = train_x[x]

    train_x_third['class'] = train_y
    spam_third = train_x_third.loc[train_x_third['class'] == 1]
    ham_third = train_x_third.loc[train_x_third['class'] == 0]

    spam_probs = list()
    for column in spam_third.iloc[:, :-1]:
        tot = 0
        for r in spam_third[column]:
            if r > 0:
                tot += 1
        prob = tot / spamCount
        spam_probs.append(prob)

    ham_probs = list()
    for column in ham_third.iloc[:, :-1]:
        tot = 0
        for r in ham_third[column]:
            if r > 0:
                tot += 1
        prob = tot / hamCount
        ham_probs.append(prob)
    theta_spam = spam_probs
    theta_ham = ham_probs

    end_time = time.time()
    print("train time:", end_time - start_time, "seconds")
    # train end
    # test start

    conf = np.array([[0, 0], [0, 0]])

    # Copy test_x because we will change it
    test_x_cp = test_x.copy()

    pred = []
    for index, row in test_x_cp.iterrows():
        i = 0

        yham = 1
        yspam = 1
        for f in third:
            x = row[f]
            if row[f] > 0:
                x = 1

            yspam *= (x * theta_spam[i] + (1 - x) * (1 - theta_spam[i]))
            yham *= (x * theta_ham[i] + (1 - x) * (1 - theta_ham[i]))
            i += 1

        yham = np.log2(yham) if yham != 0 else -math.inf
        yham += pi_ham
        yspam = np.log2(yspam) if yspam != 0 else -math.inf
        yspam += pi_spam
        pred.append(1 if yspam > yham else 0)

    TP = 0
    FP = 0
    TN = 0
    FN = 0
    i = 0
    confusion_matrix = np.array([[0, 0], [0, 0]])

    for prediction in pred:
        if prediction == 0 and test_y[i][0] == 0:
            TN += 1
        elif prediction == 0 and test_y[i][0] == 1:
            FN += 1
        elif prediction == 1 and test_y[i][0] == 1:
            TP += 1
        elif prediction == 1 and test_y[i][0] == 0:
            FP += 1
        i += 1

    confusion_matrix[0][0] = TP
    confusion_matrix[0][1] = FN
    confusion_matrix[1][0] = FP
    confusion_matrix[1][1] = TN

    acc = (TP + TN) / (TP + TN + FP + FN)
    print("Accuracy:", acc * 100)
    print("Confusion Matrix:")
    print(confusion_matrix)

    #######################################THIRD STEP#######################################
    start_time = time.time()
    fourth = list(mi_scores.keys())[-400:]

    train_x_fourth = pd.DataFrame()
    for x in fourth:
        train_x_fourth[x] = train_x[x]

    train_x_fourth['class'] = train_y
    spam_fourth = train_x_fourth.loc[train_x_fourth['class'] == 1]
    ham_fourth = train_x_fourth.loc[train_x_fourth['class'] == 0]

    spam_probs = list()
    for column in spam_fourth.iloc[:, :-1]:
        tot = 0
        for r in spam_fourth[column]:
            if r > 0:
                tot += 1
        prob = tot / spamCount
        spam_probs.append(prob)

    ham_probs = list()
    for column in ham_fourth.iloc[:, :-1]:
        tot = 0
        for r in ham_fourth[column]:
            if r > 0:
                tot += 1
        prob = tot / hamCount
        ham_probs.append(prob)
    theta_spam = spam_probs
    theta_ham = ham_probs

    end_time = time.time()
    print("train time:", end_time - start_time, "seconds")
    # train end
    # test start

    conf = np.array([[0, 0], [0, 0]])

    # Copy test_x because we will change it
    test_x_cp = test_x.copy()

    pred = []
    for index, row in test_x_cp.iterrows():
        i = 0

        yham = 1
        yspam = 1
        for f in fourth:
            x = row[f]
            if row[f] > 0:
                x = 1

            yspam *= (x * theta_spam[i] + (1 - x) * (1 - theta_spam[i]))
            yham *= (x * theta_ham[i] + (1 - x) * (1 - theta_ham[i]))
            i += 1

        yham = np.log2(yham) if yham != 0 else -math.inf
        yham += pi_ham
        yspam = np.log2(yspam) if yspam != 0 else -math.inf
        yspam += pi_spam
        pred.append(1 if yspam > yham else 0)

    TP = 0
    FP = 0
    TN = 0
    FN = 0
    i = 0
    confusion_matrix = np.array([[0, 0], [0, 0]])

    for prediction in pred:
        if prediction == 0 and test_y[i][0] == 0:
            TN += 1
        elif prediction == 0 and test_y[i][0] == 1:
            FN += 1
        elif prediction == 1 and test_y[i][0] == 1:
            TP += 1
        elif prediction == 1 and test_y[i][0] == 0:
            FP += 1
        i += 1

    confusion_matrix[0][0] = TP
    confusion_matrix[0][1] = FN
    confusion_matrix[1][0] = FP
    confusion_matrix[1][1] = TN

    acc = (TP + TN) / (TP + TN + FP + FN)
    print("Accuracy:", acc * 100)
    print("Confusion Matrix:")
    print(confusion_matrix)

    #######################################THIRD STEP#######################################
    start_time = time.time()
    fifth = list(mi_scores.keys())[-500:]

    train_x_fifth = pd.DataFrame()
    for x in fifth:
        train_x_fifth[x] = train_x[x]

    train_x_fifth['class'] = train_y
    spam_fifth = train_x_fifth.loc[train_x_fifth['class'] == 1]
    ham_fifth = train_x_fifth.loc[train_x_fifth['class'] == 0]

    spam_probs = list()
    for column in spam_fifth.iloc[:, :-1]:
        tot = 0
        for r in spam_fifth[column]:
            if r > 0:
                tot += 1
        prob = tot / spamCount
        spam_probs.append(prob)

    ham_probs = list()
    for column in ham_fifth.iloc[:, :-1]:
        tot = 0
        for r in ham_fifth[column]:
            if r > 0:
                tot += 1
        prob = tot / hamCount
        ham_probs.append(prob)
    theta_spam = spam_probs
    theta_ham = ham_probs

    end_time = time.time()
    print("train time:", end_time - start_time, "seconds")
    # train end
    # test start

    conf = np.array([[0, 0], [0, 0]])

    # Copy test_x because we will change it
    test_x_cp = test_x.copy()

    pred = []
    for index, row in test_x_cp.iterrows():
        i = 0

        yham = 1
        yspam = 1
        for f in fifth:
            x = row[f]
            if row[f] > 0:
                x = 1

            yspam *= (x * theta_spam[i] + (1 - x) * (1 - theta_spam[i]))
            yham *= (x * theta_ham[i] + (1 - x) * (1 - theta_ham[i]))
            i += 1

        yham = np.log2(yham) if yham != 0 else -math.inf
        yham += pi_ham
        yspam = np.log2(yspam) if yspam != 0 else -math.inf
        yspam += pi_spam
        pred.append(1 if yspam > yham else 0)

    TP = 0
    FP = 0
    TN = 0
    FN = 0
    i = 0
    confusion_matrix = np.array([[0, 0], [0, 0]])

    for prediction in pred:
        if prediction == 0 and test_y[i][0] == 0:
            TN += 1
        elif prediction == 0 and test_y[i][0] == 1:
            FN += 1
        elif prediction == 1 and test_y[i][0] == 1:
            TP += 1
        elif prediction == 1 and test_y[i][0] == 0:
            FP += 1
        i += 1

    confusion_matrix[0][0] = TP
    confusion_matrix[0][1] = FN
    confusion_matrix[1][0] = FP
    confusion_matrix[1][1] = TN

    acc = (TP + TN) / (TP + TN + FP + FN)
    print("Accuracy:", acc * 100)
    print("Confusion Matrix:")
    print(confusion_matrix)

    #######################################THIRD STEP#######################################
    start_time = time.time()
    sixth = list(mi_scores.keys())[-600:]

    train_x_sixth = pd.DataFrame()
    for x in sixth:
        train_x_sixth[x] = train_x[x]

    train_x_sixth['class'] = train_y
    spam_sixth = train_x_sixth.loc[train_x_sixth['class'] == 1]
    ham_sixth = train_x_sixth.loc[train_x_sixth['class'] == 0]

    spam_probs = list()
    for column in spam_sixth.iloc[:, :-1]:
        tot = 0
        for r in spam_sixth[column]:
            if r > 0:
                tot += 1
        prob = tot / spamCount
        spam_probs.append(prob)

    ham_probs = list()
    for column in ham_sixth.iloc[:, :-1]:
        tot = 0
        for r in ham_sixth[column]:
            if r > 0:
                tot += 1
        prob = tot / hamCount
        ham_probs.append(prob)
    theta_spam = spam_probs
    theta_ham = ham_probs

    end_time = time.time()
    print("train time:", end_time - start_time, "seconds")
    # train end
    # test start

    conf = np.array([[0, 0], [0, 0]])

    # Copy test_x because we will change it
    test_x_cp = test_x.copy()

    pred = []
    for index, row in test_x_cp.iterrows():
        i = 0

        yham = 1
        yspam = 1
        for f in sixth:
            x = row[f]
            if row[f] > 0:
                x = 1

            yspam *= (x * theta_spam[i] + (1 - x) * (1 - theta_spam[i]))
            yham *= (x * theta_ham[i] + (1 - x) * (1 - theta_ham[i]))
            i += 1

        yham = np.log2(yham) if yham != 0 else -math.inf
        yham += pi_ham
        yspam = np.log2(yspam) if yspam != 0 else -math.inf
        yspam += pi_spam
        pred.append(1 if yspam > yham else 0)

    TP = 0
    FP = 0
    TN = 0
    FN = 0
    i = 0
    confusion_matrix = np.array([[0, 0], [0, 0]])

    for prediction in pred:
        if prediction == 0 and test_y[i][0] == 0:
            TN += 1
        elif prediction == 0 and test_y[i][0] == 1:
            FN += 1
        elif prediction == 1 and test_y[i][0] == 1:
            TP += 1
        elif prediction == 1 and test_y[i][0] == 0:
            FP += 1
        i += 1

    confusion_matrix[0][0] = TP
    confusion_matrix[0][1] = FN
    confusion_matrix[1][0] = FP
    confusion_matrix[1][1] = TN

    acc = (TP + TN) / (TP + TN + FP + FN)
    print("Accuracy:", acc * 100)
    print("Confusion Matrix:")
    print(confusion_matrix)

def main():

    Bernoulli() #measure the train time at each step (6 in this case)

if __name__ == '__main__':
    main()
